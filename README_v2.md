# بوت الدردشة المحسن لكلية العلوم - الإصدار 2.0

## نظرة عامة
بوت دردشة ذكي محسن لكلية العلوم يوفر إجابات دقيقة وسريعة للطلاب بناءً على محتوى المقررات الدراسية.

## ✨ الميزات الجديدة في الإصدار 2.0

### 🔧 معالجة الملفات المحسنة
- **قراءة كاملة للملفات**: يقرأ 100% من محتوى ملفات PDF و Word
- **دعم الجداول**: استخراج النصوص من جداول Word بالكامل
- **معالجة الصفحات**: قراءة كل صفحة في ملفات PDF منفردة
- **التقسيم الذكي**: تقسيم النصوص الطويلة بذكاء مع الحفاظ على السياق

### 💬 نظام تسجيل المحادثات
- **جلسات المستخدمين**: تتبع كامل لجلسات الدردشة
- **تسجيل الرسائل**: حفظ كل رسالة مع الطابع الزمني
- **إحصائيات الأداء**: تتبع أوقات الاستجابة والإحصائيات
- **تاريخ المحادثات**: استرجاع المحادثات السابقة للمستخدمين

### 🚀 تحسينات الأداء
- **معالجة محسنة**: خوارزميات أفضل لفهم المحتوى
- **استجابة أسرع**: تحسين أوقات الاستجابة
- **إدارة الأخطاء**: معالجة أفضل للأخطاء والحالات الاستثنائية

## 📋 المتطلبات التقنية

### متطلبات النظام
- Python 3.8+
- SQLite أو قاعدة بيانات متوافقة
- مساحة تخزين كافية للملفات المرفوعة

### المكتبات المطلوبة
```
Flask==2.3.3
Flask-CORS==4.0.0
Flask-SQLAlchemy==3.0.5
Flask-Migrate==4.0.5
Werkzeug==2.3.7
requests==2.31.0
Pillow==10.0.1
google-generativeai==0.3.2
python-docx==0.8.11
PyPDF2==3.0.1
python-dotenv==1.0.0
gunicorn==21.2.0
cryptography==41.0.7
```

## 🚀 خطوات التثبيت والتشغيل

### 1. تحضير البيئة
```bash
# إنشاء بيئة افتراضية
python -m venv venv

# تفعيل البيئة الافتراضية
# في Windows:
venv\Scripts\activate
# في Linux/Mac:
source venv/bin/activate

# تثبيت المتطلبات
pip install -r requirements.txt
```

### 2. تهيئة قاعدة البيانات
```bash
# تهيئة Flask-Migrate
flask db init

# إنشاء migration جديدة
flask db migrate -m "Initial migration with chat logging"

# تطبيق التغييرات
flask db upgrade
```

### 3. تشغيل التطبيق
```bash
# للتطوير
python main.py

# للإنتاج
gunicorn -w 4 -b 0.0.0.0:5000 main:app
```

## 🔗 واجهات برمجة التطبيقات (APIs)

### إدارة الجلسات
- `POST /api/start_session` - بدء جلسة دردشة جديدة
- `POST /api/end_session` - إنهاء جلسة الدردشة
- `GET /api/session_stats/{session_token}` - إحصائيات الجلسة

### الدردشة والملفات
- `POST /api/chat` - إرسال سؤال
- `POST /api/upload` - رفع ملف
- `GET /api/chat_history/{user_id}` - تاريخ المحادثات

### معلومات التطبيق
- `GET /api/info` - معلومات التطبيق والميزات
- `GET /api/departments` - قائمة الأقسام
- `GET /api/files` - قائمة الملفات

## 📊 بنية قاعدة البيانات

### جداول جديدة
- `chat_sessions`: جلسات الدردشة
- `chat_messages`: الرسائل الفردية
- `users`: معلومات المستخدمين (محدث)

### العلاقات
- مستخدم واحد → جلسات متعددة
- جلسة واحدة → رسائل متعددة
- ملف واحد → أقسام متعددة

## 🛠️ الهيكل التقني

### الخدمات الجديدة
- `services/enhanced_file_service.py`: معالجة الملفات المحسنة
- `services/chat_logger.py`: إدارة المحادثات

### النماذج المحدثة
- `models/user.py`: نماذج البيانات الجديدة

### المسارات المحسنة
- `routes/chatbot.py`: APIs محدثة مع الميزات الجديدة

## 🔒 الأمان والخصوصية
- تشفير البيانات الحساسة
- حماية ضد هجمات رفع الملفات
- تسجيل آمن للمحادثات
- إدارة جلسات محسنة

## 📈 مراقبة الأداء
- تتبع أوقات الاستجابة
- إحصائيات الاستخدام
- تحليل الأخطاء
- تقارير الأداء

## 🆘 استكشاف الأخطاء

### مشاكل شائعة وحلولها
1. **خطأ في قاعدة البيانات**: تأكد من تشغيل `flask db upgrade`
2. **خطأ في المكتبات**: تحقق من تثبيت جميع المتطلبات
3. **مشاكل الملفات**: تحقق من صلاحيات المجلدات

## 🔄 التحديث من الإصدار السابق
1. نسخ احتياطي من قاعدة البيانات
2. تحديث الملفات
3. تشغيل migration
4. اختبار الوظائف الجديدة

## 📞 الدعم والمساعدة
للمساعدة التقنية أو الإبلاغ عن مشاكل، يرجى التواصل مع فريق التطوير.

## 📅 تاريخ التحديثات
- **الإصدار 2.0.0** (سبتمبر 2024): معالجة محسنة للملفات ونظام تسجيل المحادثات
- **الإصدار 1.0.0** (النسخة الأولى): الوظائف الأساسية
